<script>
/* ===============================
   CONFIGURACI√ìN
================================ */
const GUIA_AUTORIZADA = "0750925931";
const NUMERO_WHATSAPP = "573508995621";
const MAX_INTENTOS = 3;

/* ===============================
   FUNCI√ìN PRINCIPAL
================================ */
function validarYEnviarWhatsapp() {
  const guiaInput = document.getElementById("guia");
  const guia = guiaInput.value.trim();

  let intentos = parseInt(localStorage.getItem("intentosGuia")) || 0;

  if (intentos >= MAX_INTENTOS) {
    alert("üö´ Acceso bloqueado por intentos fallidos.");
    return;
  }

  if (guia === "") {
    alert("‚ö†Ô∏è Debes ingresar el n√∫mero de gu√≠a.");
    guiaInput.focus();
    return;
  }

  if (guia !== GUIA_AUTORIZADA) {
    intentos++;
    localStorage.setItem("intentosGuia", intentos);

    alert(
      "‚ùå Gu√≠a no autorizada.\n" +
      "Intentos restantes: " + (MAX_INTENTOS - intentos)
    );

    guiaInput.focus();
    return;
  }

  // ‚úîÔ∏è Gu√≠a v√°lida ‚Üí reinicia intentos
  localStorage.removeItem("intentosGuia");

  const mensaje =
    "Hola, realizo consulta de DEP√ìSITO ASEGURADO.\n" +
    "Gu√≠a autorizada: " + guia;

  const url =
    "https://wa.me/" +
    NUMERO_WHATSAPP +
    "?text=" +
    encodeURIComponent(mensaje);

  window.open(url, "_blank");
}

/* ===============================
   EVENTOS
================================ */
document
  .getElementById("btnWhatsapp")
  .addEventListener("click", validarYEnviarWhatsapp);

document
  .getElementById("btnFlotante")
  .addEventListener("click", validarYEnviarWhatsapp);
</script>
